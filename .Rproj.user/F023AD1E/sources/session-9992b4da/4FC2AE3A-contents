
# Loading package
library(e1071)
library(caTools)
library(caret)

data = read.csv(here("data", "text_tidy.csv")) %>% 
  filter(f2 > 2000 & f1 > 750 & type == "fricative" | type == "approximant")
  
removed_stimuli = data %>% 
  filter(f2 > 2000 & f1 > 750 & type == "fricative") 

# Splitting data into train
# and test data

split <- sample.split(data, SplitRatio = 0.7)
train_cl <- subset(data, split == "TRUE")
test_cl <- subset(data, split == "FALSE")

# Fitting Naive Bayes Model 
# to training dataset
set.seed(120)  # Setting Seed
classifier_cl <- naiveBayes(type ~ ., data = train_cl)
classifier_cl

# Predicting on test data'
y_pred <- predict(classifier_cl, newdata = test_cl)

# Confusion Matrix
cm <- table(test_cl$type, y_pred)
cm

# Model Evaluation
confusionMatrix(cm)